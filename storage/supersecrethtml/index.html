<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Tuff?</title>
<style>
body {
  background: #000;
  color: #33ff33;
  font-family: monospace;
  margin: 0;
  height: 100vh;
    display: flex;
    align-items: center;      /* changed from flex-start */
  justify-content: center;
  padding: 10px;
  overflow: hidden;
}

  #terminal {
    background: #000;
    border: 2px solid #33ff33;
    width: 90vw;
    max-width: 800px;
    height: 500px;
    padding: 10px;
    overflow: hidden;
    white-space: pre-wrap;
  }
  #input-line {
    display: inline;
  }
  #cursor {
    display: inline;
    animation: blink 1s step-start infinite;
  }
  @keyframes blink {
    50% { opacity: 0; }
  }
</style>
</head>
<body>
<div id="terminal">
  <div>Welcome to Fake Terminal! Type <code>curl parrot.live</code> to see the party parrot.</div>
  <div id="output"></div>
  <div id="input-line">$ <span id="input"></span><span id="cursor">â–ˆ</span></div>
</div>
<script>
const terminal = document.getElementById('terminal');
const output = document.getElementById('output');
const input = document.getElementById('input');

let command = '';
let running = false;
let idx = 0;
let timer;
let frames = [];
let lastFrameElement = null;

// Load frames from 0.txt to 9.txt in the same folder
async function loadFrames() {
  const framePromises = [];
  for (let i = 0; i < 10; i++) {
    framePromises.push(fetch(`./frames/${i}.txt`).then(res => res.text()));
  }
  frames = await Promise.all(framePromises);
}

function appendOutput(text) {
  const line = document.createElement('div');
  line.textContent = text;
  output.appendChild(line);
}

document.addEventListener('keydown', async e => {
  if (running && e.key === 'Enter') {
    clearInterval(timer);
    running = false;
    if (lastFrameElement) lastFrameElement.remove();
    appendOutput('Parrot stopped.');
    return;
  }
  if (running) return;

  if (e.key === 'Backspace') {
    command = command.slice(0, -1);
  } else if (e.key.length === 1) {
    command += e.key;
  } else if (e.key === 'Enter') {
    appendOutput('$ ' + command);
    if (command.trim() === 'curl parrot.live') {
      await runParrot();
    } else {
      appendOutput(`bash: ${command.trim().split(' ')[0]}: command not found`);
    }
    command = '';
  }
  input.textContent = command;
});

async function runParrot() {
  appendOutput('Starting parrot... (press Enter to stop)');
  input.textContent = '';
  command = '';
  running = true;
  idx = 0;

  if (frames.length === 0) await loadFrames();

  lastFrameElement = document.createElement('div');
  output.appendChild(lastFrameElement);

  const draw = () => {
    lastFrameElement.textContent = frames[idx];
    idx = (idx + 1) % frames.length;
  };

  draw();
  timer = setInterval(draw, 40);
}
</script>
</body>
</html>
